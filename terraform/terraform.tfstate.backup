{
  "version": 4,
  "terraform_version": "1.9.8",
  "serial": 117,
  "lineage": "4b1611f8-2ef0-2b74-c3a5-21e090bf1cc4",
  "outputs": {
    "attacker_ec2_public_ip": {
      "value": "54.215.42.185",
      "type": "string"
    },
    "cloudtrail_s3_bucket": {
      "value": "cloudtrail-logs-saga-dev",
      "type": "string"
    },
    "opensearch_endpoint": {
      "value": "search-security-logs-kz5ihkp2ni2yz2dtscluphu35e.us-west-1.es.amazonaws.com",
      "type": "string"
    },
    "target_ec2_public_ip": {
      "value": "204.236.171.231",
      "type": "string"
    }
  },
  "resources": [
    {
      "mode": "managed",
      "type": "aws_cloudtrail",
      "name": "security_trail",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 1,
          "attributes": {
            "advanced_event_selector": [],
            "arn": "arn:aws:cloudtrail:us-west-1:418295685377:trail/security-trail",
            "cloud_watch_logs_group_arn": "",
            "cloud_watch_logs_role_arn": "",
            "enable_log_file_validation": false,
            "enable_logging": true,
            "event_selector": [],
            "home_region": "us-west-1",
            "id": "arn:aws:cloudtrail:us-west-1:418295685377:trail/security-trail",
            "include_global_service_events": true,
            "insight_selector": [],
            "is_multi_region_trail": false,
            "is_organization_trail": false,
            "kms_key_id": "",
            "name": "security-trail",
            "s3_bucket_name": "cloudtrail-logs-saga-dev",
            "s3_key_prefix": "",
            "sns_topic_arn": "",
            "sns_topic_name": "",
            "tags": {},
            "tags_all": {
              "Application": "SAGA",
              "Terraform": "true"
            }
          },
          "sensitive_attributes": [],
          "private": "eyJzY2hlbWFfdmVyc2lvbiI6IjEifQ==",
          "dependencies": [
            "aws_s3_bucket.cloudtrail_logs",
            "aws_s3_bucket_policy.cloudtrail_policy"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_cloudwatch_log_group",
      "name": "my_log_group",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:logs:us-west-1:418295685377:log-group:/aws/lambda/my-function",
            "id": "/aws/lambda/my-function",
            "kms_key_id": "",
            "log_group_class": "STANDARD",
            "name": "/aws/lambda/my-function",
            "name_prefix": "",
            "retention_in_days": 0,
            "skip_destroy": false,
            "tags": {},
            "tags_all": {
              "Application": "SAGA",
              "Terraform": "true"
            }
          },
          "sensitive_attributes": [],
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_cloudwatch_log_group",
      "name": "security_logs",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:logs:us-west-1:418295685377:log-group:security-logs",
            "id": "security-logs",
            "kms_key_id": "",
            "log_group_class": "STANDARD",
            "name": "security-logs",
            "name_prefix": "",
            "retention_in_days": 0,
            "skip_destroy": false,
            "tags": {},
            "tags_all": {
              "Application": "SAGA",
              "Terraform": "true"
            }
          },
          "sensitive_attributes": [],
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_guardduty_detector",
      "name": "main",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "account_id": "418295685377",
            "arn": "arn:aws:guardduty:us-west-1:418295685377:detector/260f53f9bdf44df8bfc44031c91c4b25",
            "datasources": [
              {
                "kubernetes": [
                  {
                    "audit_logs": [
                      {
                        "enable": true
                      }
                    ]
                  }
                ],
                "malware_protection": [
                  {
                    "scan_ec2_instance_with_findings": [
                      {
                        "ebs_volumes": [
                          {
                            "enable": true
                          }
                        ]
                      }
                    ]
                  }
                ],
                "s3_logs": [
                  {
                    "enable": true
                  }
                ]
              }
            ],
            "enable": true,
            "finding_publishing_frequency": "SIX_HOURS",
            "id": "260f53f9bdf44df8bfc44031c91c4b25",
            "tags": {},
            "tags_all": {
              "Application": "SAGA",
              "Terraform": "true"
            }
          },
          "sensitive_attributes": [],
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_instance_profile",
      "name": "target_instance_profile",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::418295685377:instance-profile/TargetInstanceProfile",
            "create_date": "2025-02-23T20:02:12Z",
            "id": "TargetInstanceProfile",
            "name": "TargetInstanceProfile",
            "name_prefix": "",
            "path": "/",
            "role": "TargetEC2Role",
            "tags": {},
            "tags_all": {
              "Application": "SAGA",
              "Terraform": "true"
            },
            "unique_id": "AIPAWCZC5UEAWXCSTS3LA"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_iam_role.target_role"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_policy",
      "name": "firehose_policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::418295685377:policy/firehose-policy",
            "attachment_count": 1,
            "description": "Allow Firehose to write to OpenSearch",
            "id": "arn:aws:iam::418295685377:policy/firehose-policy",
            "name": "firehose-policy",
            "name_prefix": "",
            "path": "/",
            "policy": "{\"Statement\":[{\"Action\":[\"es:DescribeElasticsearchDomain\",\"es:DescribeElasticsearchDomains\",\"es:DescribeElasticsearchDomainConfig\",\"es:ESHttpPost\",\"es:ESHttpPut\",\"es:ESHttpGet\"],\"Effect\":\"Allow\",\"Resource\":\"arn:aws:es:us-west-1:418295685377:domain/security-logs\"},{\"Action\":[\"firehose:PutRecord\",\"firehose:PutRecordBatch\",\"firehose:DescribeDeliveryStream\",\"firehose:ListDeliveryStreams\"],\"Effect\":\"Allow\",\"Resource\":\"arn:aws:firehose:us-west-1:418295685377:deliverystream/ec2-logs-stream\"}],\"Version\":\"2012-10-17\"}",
            "policy_id": "ANPAWCZC5UEA2MBMLQEOP",
            "tags": {},
            "tags_all": {
              "Application": "SAGA",
              "Terraform": "true"
            }
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_iam_role.firehose_role",
            "aws_kinesis_firehose_delivery_stream.ec2_logs_stream",
            "aws_opensearch_domain.security_search",
            "aws_s3_bucket.firehose_backup",
            "random_string.bucket_suffix"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_policy",
      "name": "target_policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::418295685377:policy/TargetEC2Policy",
            "attachment_count": 1,
            "description": "Allows access to S3 and DynamoDB",
            "id": "arn:aws:iam::418295685377:policy/TargetEC2Policy",
            "name": "TargetEC2Policy",
            "name_prefix": "",
            "path": "/",
            "policy": "{\"Statement\":[{\"Action\":[\"s3:PutObject\",\"s3:GetObject\",\"s3:ListBucket\"],\"Effect\":\"Allow\",\"Resource\":[\"arn:aws:s3:::target-ec2-bucket-blybaj\",\"arn:aws:s3:::target-ec2-bucket-blybaj/*\"]},{\"Action\":[\"dynamodb:PutItem\",\"dynamodb:GetItem\",\"dynamodb:Scan\"],\"Effect\":\"Allow\",\"Resource\":\"arn:aws:dynamodb:*:*:table/TargetTable\"},{\"Action\":\"ec2:DescribeInstances\",\"Effect\":\"Allow\",\"Resource\":\"*\"},{\"Action\":[\"firehose:PutRecord\",\"firehose:PutRecordBatch\"],\"Effect\":\"Allow\",\"Resource\":\"arn:aws:firehose:us-west-1:418295685377:deliverystream/ec2-logs-stream\"}],\"Version\":\"2012-10-17\"}",
            "policy_id": "ANPAWCZC5UEAWJA46WPUC",
            "tags": {},
            "tags_all": {
              "Application": "SAGA",
              "Terraform": "true"
            }
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_iam_role.firehose_role",
            "aws_kinesis_firehose_delivery_stream.ec2_logs_stream",
            "aws_opensearch_domain.security_search",
            "aws_s3_bucket.firehose_backup",
            "aws_s3_bucket.target_bucket",
            "random_string.bucket_suffix"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_role",
      "name": "firehose_role",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::418295685377:role/firehose-role",
            "assume_role_policy": "{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"firehose.amazonaws.com\"}}],\"Version\":\"2012-10-17\"}",
            "create_date": "2025-02-23T20:02:12Z",
            "description": "",
            "force_detach_policies": false,
            "id": "firehose-role",
            "inline_policy": [],
            "managed_policy_arns": [
              "arn:aws:iam::418295685377:policy/firehose-policy"
            ],
            "max_session_duration": 3600,
            "name": "firehose-role",
            "name_prefix": "",
            "path": "/",
            "permissions_boundary": "",
            "tags": {},
            "tags_all": {
              "Application": "SAGA",
              "Terraform": "true"
            },
            "unique_id": "AROAWCZC5UEA4BQHGVCEV"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_role",
      "name": "lambda_exec",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::418295685377:role/lambda_exec_role",
            "assume_role_policy": "{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"lambda.amazonaws.com\"},\"Sid\":\"\"}],\"Version\":\"2012-10-17\"}",
            "create_date": "2025-02-23T20:02:12Z",
            "description": "",
            "force_detach_policies": false,
            "id": "lambda_exec_role",
            "inline_policy": [],
            "managed_policy_arns": [],
            "max_session_duration": 3600,
            "name": "lambda_exec_role",
            "name_prefix": "",
            "path": "/",
            "permissions_boundary": "",
            "tags": {},
            "tags_all": {
              "Application": "SAGA",
              "Terraform": "true"
            },
            "unique_id": "AROAWCZC5UEATK36E6J44"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_role",
      "name": "target_role",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::418295685377:role/TargetEC2Role",
            "assume_role_policy": "{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"ec2.amazonaws.com\"}}],\"Version\":\"2012-10-17\"}",
            "create_date": "2025-02-23T20:02:12Z",
            "description": "",
            "force_detach_policies": false,
            "id": "TargetEC2Role",
            "inline_policy": [],
            "managed_policy_arns": [
              "arn:aws:iam::418295685377:policy/TargetEC2Policy"
            ],
            "max_session_duration": 3600,
            "name": "TargetEC2Role",
            "name_prefix": "",
            "path": "/",
            "permissions_boundary": "",
            "tags": {},
            "tags_all": {
              "Application": "SAGA",
              "Terraform": "true"
            },
            "unique_id": "AROAWCZC5UEAQZWWAG6PG"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_role_policy_attachment",
      "name": "attach_target_policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "TargetEC2Role-20250223204925529700000001",
            "policy_arn": "arn:aws:iam::418295685377:policy/TargetEC2Policy",
            "role": "TargetEC2Role"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_iam_policy.target_policy",
            "aws_iam_role.firehose_role",
            "aws_iam_role.target_role",
            "aws_kinesis_firehose_delivery_stream.ec2_logs_stream",
            "aws_opensearch_domain.security_search",
            "aws_s3_bucket.firehose_backup",
            "aws_s3_bucket.target_bucket",
            "random_string.bucket_suffix"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_role_policy_attachment",
      "name": "firehose_attach",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "firehose-role-20250223202002242300000003",
            "policy_arn": "arn:aws:iam::418295685377:policy/firehose-policy",
            "role": "firehose-role"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_iam_policy.firehose_policy",
            "aws_iam_role.firehose_role",
            "aws_kinesis_firehose_delivery_stream.ec2_logs_stream",
            "aws_opensearch_domain.security_search",
            "aws_s3_bucket.firehose_backup",
            "random_string.bucket_suffix"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_instance",
      "name": "attacker_ec2",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 1,
          "attributes": {
            "ami": "ami-03392a27e4a01f1e4",
            "arn": "arn:aws:ec2:us-west-1:418295685377:instance/i-0d844c8446aa9ecd0",
            "associate_public_ip_address": true,
            "availability_zone": "us-west-1a",
            "capacity_reservation_specification": [
              {
                "capacity_reservation_preference": "open",
                "capacity_reservation_target": []
              }
            ],
            "cpu_core_count": 1,
            "cpu_options": [
              {
                "amd_sev_snp": "",
                "core_count": 1,
                "threads_per_core": 1
              }
            ],
            "cpu_threads_per_core": 1,
            "credit_specification": [
              {
                "cpu_credits": "standard"
              }
            ],
            "disable_api_stop": false,
            "disable_api_termination": false,
            "ebs_block_device": [],
            "ebs_optimized": false,
            "enable_primary_ipv6": null,
            "enclave_options": [
              {
                "enabled": false
              }
            ],
            "ephemeral_block_device": [],
            "get_password_data": false,
            "hibernation": false,
            "host_id": "",
            "host_resource_group_arn": null,
            "iam_instance_profile": "",
            "id": "i-0d844c8446aa9ecd0",
            "instance_initiated_shutdown_behavior": "stop",
            "instance_lifecycle": "",
            "instance_market_options": [],
            "instance_state": "running",
            "instance_type": "t2.micro",
            "ipv6_address_count": 0,
            "ipv6_addresses": [],
            "key_name": "ucb-saga",
            "launch_template": [],
            "maintenance_options": [
              {
                "auto_recovery": "default"
              }
            ],
            "metadata_options": [
              {
                "http_endpoint": "enabled",
                "http_protocol_ipv6": "disabled",
                "http_put_response_hop_limit": 1,
                "http_tokens": "optional",
                "instance_metadata_tags": "disabled"
              }
            ],
            "monitoring": false,
            "network_interface": [],
            "outpost_arn": "",
            "password_data": "",
            "placement_group": "",
            "placement_partition_number": 0,
            "primary_network_interface_id": "eni-0ebe6f600cffcc63a",
            "private_dns": "ip-172-31-3-42.us-west-1.compute.internal",
            "private_dns_name_options": [
              {
                "enable_resource_name_dns_a_record": false,
                "enable_resource_name_dns_aaaa_record": false,
                "hostname_type": "ip-name"
              }
            ],
            "private_ip": "172.31.3.42",
            "public_dns": "ec2-54-215-42-185.us-west-1.compute.amazonaws.com",
            "public_ip": "54.215.42.185",
            "root_block_device": [
              {
                "delete_on_termination": true,
                "device_name": "/dev/xvda",
                "encrypted": false,
                "iops": 100,
                "kms_key_id": "",
                "tags": {
                  "Application": "SAGA",
                  "Terraform": "true"
                },
                "tags_all": {
                  "Application": "SAGA",
                  "Terraform": "true"
                },
                "throughput": 0,
                "volume_id": "vol-065080dd0339a80b3",
                "volume_size": 8,
                "volume_type": "gp2"
              }
            ],
            "secondary_private_ips": [],
            "security_groups": [
              "allow_ssh"
            ],
            "source_dest_check": true,
            "spot_instance_request_id": "",
            "subnet_id": "subnet-0ec7a792f4a8e5f98",
            "tags": {
              "Name": "Attacker-System"
            },
            "tags_all": {
              "Application": "SAGA",
              "Name": "Attacker-System",
              "Terraform": "true"
            },
            "tenancy": "default",
            "timeouts": null,
            "user_data": null,
            "user_data_base64": null,
            "user_data_replace_on_change": false,
            "volume_tags": null,
            "vpc_security_group_ids": [
              "sg-051fc947f32422046"
            ]
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo2MDAwMDAwMDAwMDAsImRlbGV0ZSI6MTIwMDAwMDAwMDAwMCwicmVhZCI6OTAwMDAwMDAwMDAwLCJ1cGRhdGUiOjYwMDAwMDAwMDAwMH0sInNjaGVtYV92ZXJzaW9uIjoiMSJ9",
          "dependencies": [
            "aws_security_group.ssh_access"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_instance",
      "name": "target_ec2",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 1,
          "attributes": {
            "ami": "ami-03392a27e4a01f1e4",
            "arn": "arn:aws:ec2:us-west-1:418295685377:instance/i-0fcbfe17040cf23b9",
            "associate_public_ip_address": true,
            "availability_zone": "us-west-1a",
            "capacity_reservation_specification": [
              {
                "capacity_reservation_preference": "open",
                "capacity_reservation_target": []
              }
            ],
            "cpu_core_count": 1,
            "cpu_options": [
              {
                "amd_sev_snp": "",
                "core_count": 1,
                "threads_per_core": 1
              }
            ],
            "cpu_threads_per_core": 1,
            "credit_specification": [
              {
                "cpu_credits": "standard"
              }
            ],
            "disable_api_stop": false,
            "disable_api_termination": false,
            "ebs_block_device": [],
            "ebs_optimized": false,
            "enable_primary_ipv6": null,
            "enclave_options": [
              {
                "enabled": false
              }
            ],
            "ephemeral_block_device": [],
            "get_password_data": false,
            "hibernation": false,
            "host_id": "",
            "host_resource_group_arn": null,
            "iam_instance_profile": "TargetInstanceProfile",
            "id": "i-0fcbfe17040cf23b9",
            "instance_initiated_shutdown_behavior": "stop",
            "instance_lifecycle": "",
            "instance_market_options": [],
            "instance_state": "running",
            "instance_type": "t2.micro",
            "ipv6_address_count": 0,
            "ipv6_addresses": [],
            "key_name": "ucb-saga",
            "launch_template": [],
            "maintenance_options": [
              {
                "auto_recovery": "default"
              }
            ],
            "metadata_options": [
              {
                "http_endpoint": "enabled",
                "http_protocol_ipv6": "disabled",
                "http_put_response_hop_limit": 1,
                "http_tokens": "optional",
                "instance_metadata_tags": "disabled"
              }
            ],
            "monitoring": false,
            "network_interface": [],
            "outpost_arn": "",
            "password_data": "",
            "placement_group": "",
            "placement_partition_number": 0,
            "primary_network_interface_id": "eni-0942dfb31e1a7771e",
            "private_dns": "ip-172-31-3-82.us-west-1.compute.internal",
            "private_dns_name_options": [
              {
                "enable_resource_name_dns_a_record": false,
                "enable_resource_name_dns_aaaa_record": false,
                "hostname_type": "ip-name"
              }
            ],
            "private_ip": "172.31.3.82",
            "public_dns": "ec2-204-236-171-231.us-west-1.compute.amazonaws.com",
            "public_ip": "204.236.171.231",
            "root_block_device": [
              {
                "delete_on_termination": true,
                "device_name": "/dev/xvda",
                "encrypted": false,
                "iops": 100,
                "kms_key_id": "",
                "tags": {
                  "Application": "SAGA",
                  "Terraform": "true"
                },
                "tags_all": {
                  "Application": "SAGA",
                  "Terraform": "true"
                },
                "throughput": 0,
                "volume_id": "vol-0d2e9978930ca25c4",
                "volume_size": 8,
                "volume_type": "gp2"
              }
            ],
            "secondary_private_ips": [],
            "security_groups": [
              "allow_ssh"
            ],
            "source_dest_check": true,
            "spot_instance_request_id": "",
            "subnet_id": "subnet-0ec7a792f4a8e5f98",
            "tags": {
              "Name": "Target-System"
            },
            "tags_all": {
              "Application": "SAGA",
              "Name": "Target-System",
              "Terraform": "true"
            },
            "tenancy": "default",
            "timeouts": null,
            "user_data": null,
            "user_data_base64": null,
            "user_data_replace_on_change": false,
            "volume_tags": null,
            "vpc_security_group_ids": [
              "sg-051fc947f32422046"
            ]
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo2MDAwMDAwMDAwMDAsImRlbGV0ZSI6MTIwMDAwMDAwMDAwMCwicmVhZCI6OTAwMDAwMDAwMDAwLCJ1cGRhdGUiOjYwMDAwMDAwMDAwMH0sInNjaGVtYV92ZXJzaW9uIjoiMSJ9",
          "dependencies": [
            "aws_iam_instance_profile.target_instance_profile",
            "aws_iam_role.target_role",
            "aws_security_group.ssh_access"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_kinesis_firehose_delivery_stream",
      "name": "ec2_logs_stream",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 1,
          "attributes": {
            "arn": "arn:aws:firehose:us-west-1:418295685377:deliverystream/ec2-logs-stream",
            "destination": "elasticsearch",
            "destination_id": "destinationId-000000000001",
            "elasticsearch_configuration": [
              {
                "buffering_interval": 60,
                "buffering_size": 5,
                "cloudwatch_logging_options": [
                  {
                    "enabled": false,
                    "log_group_name": "",
                    "log_stream_name": ""
                  }
                ],
                "cluster_endpoint": "",
                "domain_arn": "arn:aws:es:us-west-1:418295685377:domain/security-logs",
                "index_name": "ec2-logs",
                "index_rotation_period": "OneDay",
                "processing_configuration": [
                  {
                    "enabled": false,
                    "processors": []
                  }
                ],
                "retry_duration": 300,
                "role_arn": "arn:aws:iam::418295685377:role/firehose-role",
                "s3_backup_mode": "FailedDocumentsOnly",
                "s3_configuration": [
                  {
                    "bucket_arn": "arn:aws:s3:::firehose-backup-logs-blybaj",
                    "buffering_interval": 300,
                    "buffering_size": 5,
                    "cloudwatch_logging_options": [
                      {
                        "enabled": false,
                        "log_group_name": "",
                        "log_stream_name": ""
                      }
                    ],
                    "compression_format": "GZIP",
                    "error_output_prefix": "",
                    "kms_key_arn": "",
                    "prefix": "",
                    "role_arn": "arn:aws:iam::418295685377:role/firehose-role"
                  }
                ],
                "type_name": "",
                "vpc_config": []
              }
            ],
            "extended_s3_configuration": [],
            "http_endpoint_configuration": [],
            "iceberg_configuration": [],
            "id": "arn:aws:firehose:us-west-1:418295685377:deliverystream/ec2-logs-stream",
            "kinesis_source_configuration": [],
            "msk_source_configuration": [],
            "name": "ec2-logs-stream",
            "opensearch_configuration": [],
            "opensearchserverless_configuration": [],
            "redshift_configuration": [],
            "server_side_encryption": [
              {
                "enabled": false,
                "key_arn": "",
                "key_type": "AWS_OWNED_CMK"
              }
            ],
            "snowflake_configuration": [],
            "splunk_configuration": [],
            "tags": {},
            "tags_all": {
              "Application": "SAGA",
              "Terraform": "true"
            },
            "timeouts": null,
            "version_id": "1"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInVwZGF0ZSI6NjAwMDAwMDAwMDAwfSwic2NoZW1hX3ZlcnNpb24iOiIxIn0=",
          "dependencies": [
            "aws_iam_role.firehose_role",
            "aws_opensearch_domain.security_search",
            "aws_s3_bucket.firehose_backup",
            "random_string.bucket_suffix"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_lambda_function",
      "name": "log_ingestor",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "architectures": [
              "x86_64"
            ],
            "arn": "arn:aws:lambda:us-west-1:418295685377:function:log_ingestor",
            "code_sha256": "AqJNSLScQi4WguhvAdxf1ryzPEG4hLQnjg7p3lth/cc=",
            "code_signing_config_arn": "",
            "dead_letter_config": [],
            "description": "",
            "environment": [
              {
                "variables": {
                  "OPENSEARCH_ENDPOINT": "search-security-logs-kz5ihkp2ni2yz2dtscluphu35e.us-west-1.es.amazonaws.com"
                }
              }
            ],
            "ephemeral_storage": [
              {
                "size": 512
              }
            ],
            "file_system_config": [],
            "filename": "lambda.zip",
            "function_name": "log_ingestor",
            "handler": "log_ingestor.lambda_handler",
            "id": "log_ingestor",
            "image_config": [],
            "image_uri": "",
            "invoke_arn": "arn:aws:apigateway:us-west-1:lambda:path/2015-03-31/functions/arn:aws:lambda:us-west-1:418295685377:function:log_ingestor/invocations",
            "kms_key_arn": "",
            "last_modified": "2025-02-23T20:20:01.702+0000",
            "layers": [],
            "logging_config": [
              {
                "application_log_level": "",
                "log_format": "Text",
                "log_group": "/aws/lambda/log_ingestor",
                "system_log_level": ""
              }
            ],
            "memory_size": 128,
            "package_type": "Zip",
            "publish": false,
            "qualified_arn": "arn:aws:lambda:us-west-1:418295685377:function:log_ingestor:$LATEST",
            "qualified_invoke_arn": "arn:aws:apigateway:us-west-1:lambda:path/2015-03-31/functions/arn:aws:lambda:us-west-1:418295685377:function:log_ingestor:$LATEST/invocations",
            "replace_security_groups_on_destroy": null,
            "replacement_security_group_ids": null,
            "reserved_concurrent_executions": -1,
            "role": "arn:aws:iam::418295685377:role/lambda_exec_role",
            "runtime": "python3.9",
            "s3_bucket": null,
            "s3_key": null,
            "s3_object_version": null,
            "signing_job_arn": "",
            "signing_profile_version_arn": "",
            "skip_destroy": false,
            "snap_start": [],
            "source_code_hash": "",
            "source_code_size": 607,
            "tags": {},
            "tags_all": {
              "Application": "SAGA",
              "Terraform": "true"
            },
            "timeout": 3,
            "timeouts": null,
            "tracing_config": [
              {
                "mode": "PassThrough"
              }
            ],
            "version": "$LATEST",
            "vpc_config": []
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo2MDAwMDAwMDAwMDAsImRlbGV0ZSI6NjAwMDAwMDAwMDAwLCJ1cGRhdGUiOjYwMDAwMDAwMDAwMH19",
          "dependencies": [
            "aws_iam_role.lambda_exec",
            "aws_opensearch_domain.security_search"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_lambda_function",
      "name": "log_processor",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "architectures": [
              "x86_64"
            ],
            "arn": "arn:aws:lambda:us-west-1:418295685377:function:process_security_logs",
            "code_sha256": "AqJNSLScQi4WguhvAdxf1ryzPEG4hLQnjg7p3lth/cc=",
            "code_signing_config_arn": "",
            "dead_letter_config": [],
            "description": "",
            "environment": [],
            "ephemeral_storage": [
              {
                "size": 512
              }
            ],
            "file_system_config": [],
            "filename": "lambda.zip",
            "function_name": "process_security_logs",
            "handler": "lambda_function.lambda_handler",
            "id": "process_security_logs",
            "image_config": [],
            "image_uri": "",
            "invoke_arn": "arn:aws:apigateway:us-west-1:lambda:path/2015-03-31/functions/arn:aws:lambda:us-west-1:418295685377:function:process_security_logs/invocations",
            "kms_key_arn": "",
            "last_modified": "2025-02-23T20:02:20.844+0000",
            "layers": [],
            "logging_config": [
              {
                "application_log_level": "",
                "log_format": "Text",
                "log_group": "/aws/lambda/process_security_logs",
                "system_log_level": ""
              }
            ],
            "memory_size": 128,
            "package_type": "Zip",
            "publish": false,
            "qualified_arn": "arn:aws:lambda:us-west-1:418295685377:function:process_security_logs:$LATEST",
            "qualified_invoke_arn": "arn:aws:apigateway:us-west-1:lambda:path/2015-03-31/functions/arn:aws:lambda:us-west-1:418295685377:function:process_security_logs:$LATEST/invocations",
            "replace_security_groups_on_destroy": null,
            "replacement_security_group_ids": null,
            "reserved_concurrent_executions": -1,
            "role": "arn:aws:iam::418295685377:role/lambda_exec_role",
            "runtime": "python3.9",
            "s3_bucket": null,
            "s3_key": null,
            "s3_object_version": null,
            "signing_job_arn": "",
            "signing_profile_version_arn": "",
            "skip_destroy": false,
            "snap_start": [],
            "source_code_hash": "",
            "source_code_size": 607,
            "tags": {},
            "tags_all": {
              "Application": "SAGA",
              "Terraform": "true"
            },
            "timeout": 3,
            "timeouts": null,
            "tracing_config": [
              {
                "mode": "PassThrough"
              }
            ],
            "version": "$LATEST",
            "vpc_config": []
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo2MDAwMDAwMDAwMDAsImRlbGV0ZSI6NjAwMDAwMDAwMDAwLCJ1cGRhdGUiOjYwMDAwMDAwMDAwMH19",
          "dependencies": [
            "aws_iam_role.lambda_exec"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_opensearch_domain",
      "name": "security_search",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "access_policies": null,
            "advanced_options": {},
            "advanced_security_options": [],
            "arn": "arn:aws:es:us-west-1:418295685377:domain/security-logs",
            "auto_tune_options": [
              {
                "desired_state": "DISABLED",
                "maintenance_schedule": [],
                "rollback_on_disable": "NO_ROLLBACK",
                "use_off_peak_window": false
              }
            ],
            "cluster_config": [
              {
                "cold_storage_options": [
                  {
                    "enabled": false
                  }
                ],
                "dedicated_master_count": 0,
                "dedicated_master_enabled": false,
                "dedicated_master_type": "",
                "instance_count": 1,
                "instance_type": "t3.small.search",
                "multi_az_with_standby_enabled": false,
                "warm_count": 0,
                "warm_enabled": false,
                "warm_type": "",
                "zone_awareness_config": [],
                "zone_awareness_enabled": false
              }
            ],
            "cognito_options": [
              {
                "enabled": false,
                "identity_pool_id": "",
                "role_arn": "",
                "user_pool_id": ""
              }
            ],
            "dashboard_endpoint": "search-security-logs-kz5ihkp2ni2yz2dtscluphu35e.us-west-1.es.amazonaws.com/_dashboards",
            "dashboard_endpoint_v2": null,
            "domain_endpoint_options": [
              {
                "custom_endpoint": "",
                "custom_endpoint_certificate_arn": "",
                "custom_endpoint_enabled": false,
                "enforce_https": false,
                "tls_security_policy": "Policy-Min-TLS-1-2-2019-07"
              }
            ],
            "domain_endpoint_v2_hosted_zone_id": "",
            "domain_id": "418295685377/security-logs",
            "domain_name": "security-logs",
            "ebs_options": [
              {
                "ebs_enabled": true,
                "iops": 3000,
                "throughput": 125,
                "volume_size": 10,
                "volume_type": "gp3"
              }
            ],
            "encrypt_at_rest": [
              {
                "enabled": false,
                "kms_key_id": ""
              }
            ],
            "endpoint": "search-security-logs-kz5ihkp2ni2yz2dtscluphu35e.us-west-1.es.amazonaws.com",
            "endpoint_v2": null,
            "engine_version": "OpenSearch_2.3",
            "id": "arn:aws:es:us-west-1:418295685377:domain/security-logs",
            "ip_address_type": "ipv4",
            "kibana_endpoint": "search-security-logs-kz5ihkp2ni2yz2dtscluphu35e.us-west-1.es.amazonaws.com/_plugin/kibana/",
            "log_publishing_options": [],
            "node_to_node_encryption": [
              {
                "enabled": false
              }
            ],
            "off_peak_window_options": [
              {
                "enabled": true,
                "off_peak_window": [
                  {
                    "window_start_time": [
                      {
                        "hours": 6,
                        "minutes": 0
                      }
                    ]
                  }
                ]
              }
            ],
            "snapshot_options": [
              {
                "automated_snapshot_start_hour": 0
              }
            ],
            "software_update_options": [
              {
                "auto_software_update_enabled": false
              }
            ],
            "tags": {},
            "tags_all": {
              "Application": "SAGA",
              "Terraform": "true"
            },
            "timeouts": null,
            "vpc_options": []
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo3MjAwMDAwMDAwMDAwLCJkZWxldGUiOjU0MDAwMDAwMDAwMDAsInVwZGF0ZSI6MTA4MDAwMDAwMDAwMDB9fQ=="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_s3_bucket",
      "name": "cloudtrail_logs",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "acceleration_status": "",
            "acl": null,
            "arn": "arn:aws:s3:::cloudtrail-logs-saga-dev",
            "bucket": "cloudtrail-logs-saga-dev",
            "bucket_domain_name": "cloudtrail-logs-saga-dev.s3.amazonaws.com",
            "bucket_prefix": "",
            "bucket_regional_domain_name": "cloudtrail-logs-saga-dev.s3.us-west-1.amazonaws.com",
            "cors_rule": [],
            "force_destroy": false,
            "grant": [
              {
                "id": "72a7c9e857c5e9f29cef82013ba866a35eb1211388b0e897ce6ccd8f45d859f4",
                "permissions": [
                  "FULL_CONTROL"
                ],
                "type": "CanonicalUser",
                "uri": ""
              }
            ],
            "hosted_zone_id": "Z2F56UZL2M1ACD",
            "id": "cloudtrail-logs-saga-dev",
            "lifecycle_rule": [],
            "logging": [],
            "object_lock_configuration": [],
            "object_lock_enabled": false,
            "policy": "{\"Statement\":[{\"Action\":\"s3:GetBucketAcl\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"cloudtrail.amazonaws.com\"},\"Resource\":\"arn:aws:s3:::cloudtrail-logs-saga-dev\"},{\"Action\":\"s3:PutObject\",\"Condition\":{\"StringEquals\":{\"s3:x-amz-acl\":\"bucket-owner-full-control\"}},\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"cloudtrail.amazonaws.com\"},\"Resource\":\"arn:aws:s3:::cloudtrail-logs-saga-dev/*\"}],\"Version\":\"2012-10-17\"}",
            "region": "us-west-1",
            "replication_configuration": [],
            "request_payer": "BucketOwner",
            "server_side_encryption_configuration": [
              {
                "rule": [
                  {
                    "apply_server_side_encryption_by_default": [
                      {
                        "kms_master_key_id": "",
                        "sse_algorithm": "AES256"
                      }
                    ],
                    "bucket_key_enabled": false
                  }
                ]
              }
            ],
            "tags": {},
            "tags_all": {
              "Application": "SAGA",
              "Terraform": "true"
            },
            "timeouts": null,
            "versioning": [
              {
                "enabled": false,
                "mfa_delete": false
              }
            ],
            "website": [],
            "website_domain": null,
            "website_endpoint": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAwLCJkZWxldGUiOjM2MDAwMDAwMDAwMDAsInJlYWQiOjEyMDAwMDAwMDAwMDAsInVwZGF0ZSI6MTIwMDAwMDAwMDAwMH19"
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_s3_bucket",
      "name": "firehose_backup",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "acceleration_status": "",
            "acl": null,
            "arn": "arn:aws:s3:::firehose-backup-logs-blybaj",
            "bucket": "firehose-backup-logs-blybaj",
            "bucket_domain_name": "firehose-backup-logs-blybaj.s3.amazonaws.com",
            "bucket_prefix": "",
            "bucket_regional_domain_name": "firehose-backup-logs-blybaj.s3.us-west-1.amazonaws.com",
            "cors_rule": [],
            "force_destroy": false,
            "grant": [
              {
                "id": "72a7c9e857c5e9f29cef82013ba866a35eb1211388b0e897ce6ccd8f45d859f4",
                "permissions": [
                  "FULL_CONTROL"
                ],
                "type": "CanonicalUser",
                "uri": ""
              }
            ],
            "hosted_zone_id": "Z2F56UZL2M1ACD",
            "id": "firehose-backup-logs-blybaj",
            "lifecycle_rule": [],
            "logging": [],
            "object_lock_configuration": [],
            "object_lock_enabled": false,
            "policy": "",
            "region": "us-west-1",
            "replication_configuration": [],
            "request_payer": "BucketOwner",
            "server_side_encryption_configuration": [
              {
                "rule": [
                  {
                    "apply_server_side_encryption_by_default": [
                      {
                        "kms_master_key_id": "",
                        "sse_algorithm": "AES256"
                      }
                    ],
                    "bucket_key_enabled": false
                  }
                ]
              }
            ],
            "tags": {},
            "tags_all": {
              "Application": "SAGA",
              "Terraform": "true"
            },
            "timeouts": null,
            "versioning": [
              {
                "enabled": false,
                "mfa_delete": false
              }
            ],
            "website": [],
            "website_domain": null,
            "website_endpoint": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAwLCJkZWxldGUiOjM2MDAwMDAwMDAwMDAsInJlYWQiOjEyMDAwMDAwMDAwMDAsInVwZGF0ZSI6MTIwMDAwMDAwMDAwMH19",
          "dependencies": [
            "random_string.bucket_suffix"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_s3_bucket",
      "name": "target_bucket",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "acceleration_status": "",
            "acl": null,
            "arn": "arn:aws:s3:::target-ec2-bucket-blybaj",
            "bucket": "target-ec2-bucket-blybaj",
            "bucket_domain_name": "target-ec2-bucket-blybaj.s3.amazonaws.com",
            "bucket_prefix": "",
            "bucket_regional_domain_name": "target-ec2-bucket-blybaj.s3.us-west-1.amazonaws.com",
            "cors_rule": [],
            "force_destroy": false,
            "grant": [
              {
                "id": "72a7c9e857c5e9f29cef82013ba866a35eb1211388b0e897ce6ccd8f45d859f4",
                "permissions": [
                  "FULL_CONTROL"
                ],
                "type": "CanonicalUser",
                "uri": ""
              }
            ],
            "hosted_zone_id": "Z2F56UZL2M1ACD",
            "id": "target-ec2-bucket-blybaj",
            "lifecycle_rule": [],
            "logging": [],
            "object_lock_configuration": [],
            "object_lock_enabled": false,
            "policy": "",
            "region": "us-west-1",
            "replication_configuration": [],
            "request_payer": "BucketOwner",
            "server_side_encryption_configuration": [
              {
                "rule": [
                  {
                    "apply_server_side_encryption_by_default": [
                      {
                        "kms_master_key_id": "",
                        "sse_algorithm": "AES256"
                      }
                    ],
                    "bucket_key_enabled": false
                  }
                ]
              }
            ],
            "tags": {},
            "tags_all": {
              "Application": "SAGA",
              "Terraform": "true"
            },
            "timeouts": null,
            "versioning": [
              {
                "enabled": false,
                "mfa_delete": false
              }
            ],
            "website": [],
            "website_domain": null,
            "website_endpoint": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAwLCJkZWxldGUiOjM2MDAwMDAwMDAwMDAsInJlYWQiOjEyMDAwMDAwMDAwMDAsInVwZGF0ZSI6MTIwMDAwMDAwMDAwMH19",
          "dependencies": [
            "random_string.bucket_suffix"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_s3_bucket_policy",
      "name": "cloudtrail_policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "bucket": "cloudtrail-logs-saga-dev",
            "id": "cloudtrail-logs-saga-dev",
            "policy": "{\"Statement\":[{\"Action\":\"s3:GetBucketAcl\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"cloudtrail.amazonaws.com\"},\"Resource\":\"arn:aws:s3:::cloudtrail-logs-saga-dev\"},{\"Action\":\"s3:PutObject\",\"Condition\":{\"StringEquals\":{\"s3:x-amz-acl\":\"bucket-owner-full-control\"}},\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"cloudtrail.amazonaws.com\"},\"Resource\":\"arn:aws:s3:::cloudtrail-logs-saga-dev/*\"}],\"Version\":\"2012-10-17\"}"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_s3_bucket.cloudtrail_logs"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_s3_bucket_public_access_block",
      "name": "cloudtrail_logs",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "block_public_acls": true,
            "block_public_policy": true,
            "bucket": "cloudtrail-logs-saga-dev",
            "id": "cloudtrail-logs-saga-dev",
            "ignore_public_acls": true,
            "restrict_public_buckets": true
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_s3_bucket.cloudtrail_logs"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_s3_bucket_public_access_block",
      "name": "firehose_backup",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "block_public_acls": true,
            "block_public_policy": true,
            "bucket": "firehose-backup-logs-blybaj",
            "id": "firehose-backup-logs-blybaj",
            "ignore_public_acls": true,
            "restrict_public_buckets": true
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_s3_bucket.firehose_backup",
            "random_string.bucket_suffix"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_security_group",
      "name": "ssh_access",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 1,
          "attributes": {
            "arn": "arn:aws:ec2:us-west-1:418295685377:security-group/sg-051fc947f32422046",
            "description": "Allow SSH from specific IP",
            "egress": [
              {
                "cidr_blocks": [
                  "0.0.0.0/0"
                ],
                "description": "",
                "from_port": 0,
                "ipv6_cidr_blocks": [],
                "prefix_list_ids": [],
                "protocol": "-1",
                "security_groups": [],
                "self": false,
                "to_port": 0
              }
            ],
            "id": "sg-051fc947f32422046",
            "ingress": [
              {
                "cidr_blocks": [
                  "70.224.83.39/32"
                ],
                "description": "",
                "from_port": 22,
                "ipv6_cidr_blocks": [],
                "prefix_list_ids": [],
                "protocol": "tcp",
                "security_groups": [],
                "self": false,
                "to_port": 22
              }
            ],
            "name": "allow_ssh",
            "name_prefix": "",
            "owner_id": "418295685377",
            "revoke_rules_on_delete": false,
            "tags": {},
            "tags_all": {
              "Application": "SAGA",
              "Terraform": "true"
            },
            "timeouts": null,
            "vpc_id": "vpc-0e52bef2312c1b1f9"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo2MDAwMDAwMDAwMDAsImRlbGV0ZSI6OTAwMDAwMDAwMDAwfSwic2NoZW1hX3ZlcnNpb24iOiIxIn0="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_ssm_association",
      "name": "attacker_ec2",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 1,
          "attributes": {
            "apply_only_at_cron_interval": false,
            "arn": "arn:aws:ssm:us-west-1:418295685377:association/178aedb2-dc0e-4f91-ad5a-09f414e6f7ec",
            "association_id": "178aedb2-dc0e-4f91-ad5a-09f414e6f7ec",
            "association_name": "",
            "automation_target_parameter_name": "",
            "compliance_severity": "",
            "document_version": "$DEFAULT",
            "id": "178aedb2-dc0e-4f91-ad5a-09f414e6f7ec",
            "instance_id": "i-0d844c8446aa9ecd0",
            "max_concurrency": "",
            "max_errors": "",
            "name": "InstallFluentBit",
            "output_location": [],
            "parameters": {},
            "schedule_expression": "",
            "sync_compliance": "",
            "tags": {},
            "tags_all": {
              "Application": "SAGA",
              "Terraform": "true"
            },
            "targets": [
              {
                "key": "InstanceIds",
                "values": [
                  "i-0d844c8446aa9ecd0"
                ]
              }
            ],
            "wait_for_success_timeout_seconds": null
          },
          "sensitive_attributes": [],
          "private": "eyJzY2hlbWFfdmVyc2lvbiI6IjEifQ==",
          "dependencies": [
            "aws_instance.attacker_ec2",
            "aws_security_group.ssh_access",
            "aws_ssm_document.fluentbit_install"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_ssm_association",
      "name": "target_ec2",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 1,
          "attributes": {
            "apply_only_at_cron_interval": false,
            "arn": "arn:aws:ssm:us-west-1:418295685377:association/eab3fa68-e722-41a5-b9fc-0115b417dd23",
            "association_id": "eab3fa68-e722-41a5-b9fc-0115b417dd23",
            "association_name": "",
            "automation_target_parameter_name": "",
            "compliance_severity": "",
            "document_version": "$DEFAULT",
            "id": "eab3fa68-e722-41a5-b9fc-0115b417dd23",
            "instance_id": "i-0fcbfe17040cf23b9",
            "max_concurrency": "",
            "max_errors": "",
            "name": "InstallFluentBit",
            "output_location": [],
            "parameters": {},
            "schedule_expression": "",
            "sync_compliance": "",
            "tags": {},
            "tags_all": {
              "Application": "SAGA",
              "Terraform": "true"
            },
            "targets": [
              {
                "key": "InstanceIds",
                "values": [
                  "i-0fcbfe17040cf23b9"
                ]
              }
            ],
            "wait_for_success_timeout_seconds": null
          },
          "sensitive_attributes": [],
          "private": "eyJzY2hlbWFfdmVyc2lvbiI6IjEifQ==",
          "dependencies": [
            "aws_iam_instance_profile.target_instance_profile",
            "aws_iam_role.target_role",
            "aws_instance.target_ec2",
            "aws_security_group.ssh_access",
            "aws_ssm_document.fluentbit_install"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_ssm_document",
      "name": "fluentbit_install",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:ssm:us-west-1:418295685377:document/InstallFluentBit",
            "attachments_source": [],
            "content": "  {\n    \"schemaVersion\": \"1.2\",\n    \"description\": \"Check ip configuration of a Linux instance.\",\n    \"parameters\": {\n\n    },\n    \"runtimeConfig\": {\n      \"aws:runShellScript\": {\n        \"properties\": [\n          {\n            \"id\": \"0.aws:runShellScript\",\n            \"runCommand\": [\"sudo yum install -y fluent-bit\",\n            \"echo '[SERVICE]' \u003e /etc/fluent-bit/fluent-bit.conf\",\n            \"echo '    Flush 5' \u003e\u003e /etc/fluent-bit/fluent-bit.conf\",\n            \"echo '[INPUT]' \u003e\u003e /etc/fluent-bit/fluent-bit.conf\",\n            \"echo '    Name tail' \u003e\u003e /etc/fluent-bit/fluent-bit.conf\",\n            \"echo '    Path /var/log/messages, /var/log/syslog' \u003e\u003e /etc/fluent-bit/fluent-bit.conf\",\n            \"echo '[FILTER]' \u003e\u003e /etc/fluent-bit/fluent-bit.conf\",\n            \"echo '    Name record_modifier' \u003e\u003e /etc/fluent-bit/fluent-bit.conf\",\n            \"echo '    Record instance_id $$AWS_INSTANCE_ID' \u003e\u003e /etc/fluent-bit/fluent-bit.conf\",\n            \"echo '[OUTPUT]' \u003e\u003e /etc/fluent-bit/fluent-bit.conf\",\n            \"echo '    Name kinesis_firehose' \u003e\u003e /etc/fluent-bit/fluent-bit.conf\",\n            \"echo '    Match *' \u003e\u003e /etc/fluent-bit/fluent-bit.conf\",\n            \"echo '    region us-west-1' \u003e\u003e /etc/fluent-bit/fluent-bit.conf\",\n            \"echo '    delivery_stream ec2-logs-stream' \u003e\u003e /etc/fluent-bit/fluent-bit.conf\",\n            \"sudo systemctl enable fluent-bit\",\n            \"sudo systemctl start fluent-bit\"]\n          }\n        ]\n      }\n    }\n  }\n",
            "created_date": "2025-02-23T20:49:24Z",
            "default_version": "1",
            "description": "Check ip configuration of a Linux instance.",
            "document_format": "JSON",
            "document_type": "Command",
            "document_version": "1",
            "hash": "e6d0f843a4beb83bc38264cb820778925377c8856327c69d4c4ef072e5c4da47",
            "hash_type": "Sha256",
            "id": "InstallFluentBit",
            "latest_version": "1",
            "name": "InstallFluentBit",
            "owner": "418295685377",
            "parameter": [],
            "permissions": {},
            "platform_types": [
              "Linux",
              "MacOS"
            ],
            "schema_version": "1.2",
            "status": "Active",
            "tags": {},
            "tags_all": {
              "Application": "SAGA",
              "Terraform": "true"
            },
            "target_type": "",
            "version_name": ""
          },
          "sensitive_attributes": [],
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "random_string",
      "name": "bucket_suffix",
      "provider": "provider[\"registry.terraform.io/hashicorp/random\"]",
      "instances": [
        {
          "schema_version": 2,
          "attributes": {
            "id": "blybaj",
            "keepers": null,
            "length": 6,
            "lower": true,
            "min_lower": 0,
            "min_numeric": 0,
            "min_special": 0,
            "min_upper": 0,
            "number": true,
            "numeric": true,
            "override_special": null,
            "result": "blybaj",
            "special": false,
            "upper": false
          },
          "sensitive_attributes": []
        }
      ]
    }
  ],
  "check_results": null
}
